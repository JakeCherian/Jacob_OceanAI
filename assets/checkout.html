<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>E-Shop Checkout</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .container { max-width: 900px; margin: 0 auto; }
    h1 { color: #222; }
    .product { display: flex; justify-content: space-between; margin-bottom: 10px; padding: 10px; border: 1px solid #ddd; }
    .cart-summary { border: 1px solid #ccc; padding: 10px; margin-top: 20px; }
    .error { color: red; font-size: 0.9em; }
    .success { color: green; font-size: 1em; font-weight: bold; }
    .btn { padding: 8px 12px; border: none; border-radius: 4px; cursor: pointer; }
    .btn-add { background: #007bff; color: white; }
    .btn-apply { background: #444; color: white; }
    #pay_now { background: #28a745; color: white; }
    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    fieldset { border: 1px solid #ddd; padding: 10px; }
    label { display: block; margin-bottom: 4px; }
    input[type="text"], input[type="email"], input[type="number"] { width: 100%; padding: 6px; box-sizing: border-box; }
  </style>
</head>
<body>
  <div class="container">
    <h1>E-Shop Checkout</h1>

    <section id="product_list">
      <div class="product" data-item-id="1">
        <div>
          <strong>Widget A</strong><br/>
          <span>$<span class="price" id="price-1">20.00</span></span>
        </div>
        <button id="add-item-1" class="btn btn-add" data-item="1" data-price="20.00">Add to Cart</button>
      </div>
      <div class="product" data-item-id="2">
        <div>
          <strong>Widget B</strong><br/>
          <span>$<span class="price" id="price-2">35.00</span></span>
        </div>
        <button id="add-item-2" class="btn btn-add" data-item="2" data-price="35.00">Add to Cart</button>
      </div>
      <div class="product" data-item-id="3">
        <div>
          <strong>Gadget C</strong><br/>
          <span>$<span class="price" id="price-3">12.50</span></span>
        </div>
        <button id="add-item-3" class="btn btn-add" data-item="3" data-price="12.50">Add to Cart</button>
      </div>
    </section>

    <section id="cart" class="cart-summary">
      <h2>Cart Summary</h2>
      <div>
        <label for="qty-item-1">Widget A Quantity</label>
        <input type="number" id="qty-item-1" min="0" value="0" />
      </div>
      <div>
        <label for="qty-item-2">Widget B Quantity</label>
        <input type="number" id="qty-item-2" min="0" value="0" />
      </div>
      <div>
        <label for="qty-item-3">Gadget C Quantity</label>
        <input type="number" id="qty-item-3" min="0" value="0" />
      </div>

      <div style="margin-top: 10px;">
        <label for="discount_code">Discount Code</label>
        <input type="text" id="discount_code" placeholder="Enter code (e.g., SAVE15)" />
        <button id="apply_coupon" class="btn btn-apply">Apply Coupon</button>
        <div id="discount_error" class="error"></div>
      </div>

      <div style="margin-top: 10px;">
        <strong>Subtotal: $<span id="subtotal">0.00</span></strong><br/>
        <strong>Discount: -$<span id="discount">0.00</span></strong><br/>
        <strong>Shipping: $<span id="shipping_cost">0.00</span></strong><br/>
        <strong>Total: $<span id="total">0.00</span></strong>
      </div>
    </section>

    <section id="user_details" style="margin-top: 20px;">
      <h2>User Details</h2>
      <div class="grid">
        <div>
          <label for="name">Name</label>
          <input type="text" id="name" />
          <div id="name_error" class="error"></div>
        </div>
        <div>
          <label for="email">Email</label>
          <input type="email" id="email" />
          <div id="email_error" class="error"></div>
        </div>
      </div>
      <div>
        <label for="address">Address</label>
        <input type="text" id="address" />
        <div id="address_error" class="error"></div>
      </div>
    </section>

    <section id="shipping_payment" style="margin-top: 20px;">
      <div class="grid">
        <fieldset>
          <legend>Shipping Method</legend>
          <label><input type="radio" name="shipping_method" id="shipping_standard" value="standard" checked /> Standard (Free)</label>
          <label><input type="radio" name="shipping_method" id="shipping_express" value="express" /> Express ($10)</label>
        </fieldset>
        <fieldset>
          <legend>Payment Method</legend>
          <label><input type="radio" name="payment_method" id="pay_credit" value="credit_card" checked /> Credit Card</label>
          <label><input type="radio" name="payment_method" id="pay_paypal" value="paypal" /> PayPal</label>
        </fieldset>
      </div>
    </section>

    <section id="actions" style="margin-top: 20px;">
      <button id="pay_now" class="btn">Pay Now</button>
      <div id="payment_status" class="success" style="margin-top: 10px;"></div>
    </section>
  </div>

  <script>
    const prices = {1: 20.00, 2: 35.00, 3: 12.50};
    const qtyInputs = {
      1: document.getElementById('qty-item-1'),
      2: document.getElementById('qty-item-2'),
      3: document.getElementById('qty-item-3')
    };

    const subtotalEl = document.getElementById('subtotal');
    const discountEl = document.getElementById('discount');
    const shippingEl = document.getElementById('shipping_cost');
    const totalEl = document.getElementById('total');
    const discountCodeInput = document.getElementById('discount_code');
    const discountError = document.getElementById('discount_error');

    const shippingStandard = document.getElementById('shipping_standard');
    const shippingExpress = document.getElementById('shipping_express');

    const nameInput = document.getElementById('name');
    const emailInput = document.getElementById('email');
    const addressInput = document.getElementById('address');
    const nameError = document.getElementById('name_error');
    const emailError = document.getElementById('email_error');
    const addressError = document.getElementById('address_error');
    const payNowBtn = document.getElementById('pay_now');
    const paymentStatus = document.getElementById('payment_status');

    let appliedDiscount = 0.0;

    function recalc() {
      let subtotal = 0.0;
      for (const id of [1,2,3]) {
        const qty = parseInt(qtyInputs[id].value || '0', 10);
        subtotal += qty * prices[id];
      }

      const shippingCost = shippingExpress.checked ? 10.0 : 0.0;
      const discount = appliedDiscount;
      const total = Math.max(0, subtotal - discount + shippingCost);

      subtotalEl.textContent = subtotal.toFixed(2);
      discountEl.textContent = discount.toFixed(2);
      shippingEl.textContent = shippingCost.toFixed(2);
      totalEl.textContent = total.toFixed(2);
    }

    for (const id of [1,2,3]) {
      qtyInputs[id].addEventListener('input', recalc);
      document.getElementById(`add-item-${id}`).addEventListener('click', () => {
        qtyInputs[id].value = parseInt(qtyInputs[id].value || '0', 10) + 1;
        recalc();
      });
    }

    shippingStandard.addEventListener('change', recalc);
    shippingExpress.addEventListener('change', recalc);

    document.getElementById('apply_coupon').addEventListener('click', () => {
      const code = (discountCodeInput.value || '').trim().toUpperCase();
      discountError.textContent = '';
      let subtotal = parseFloat(subtotalEl.textContent || '0');
      if (!code) {
        appliedDiscount = 0.0;
        recalc();
        return;
      }
      if (code === 'SAVE15') {
        appliedDiscount = subtotal * 0.15;
      } else {
        appliedDiscount = 0.0;
        discountError.textContent = 'Invalid discount code.';
      }
      recalc();
    });

    function validateForm() {
      let valid = true;
      nameError.textContent = '';
      emailError.textContent = '';
      addressError.textContent = '';

      if (!nameInput.value.trim()) { nameError.textContent = 'Name is required.'; valid = false; }
      const emailVal = emailInput.value.trim();
      if (!emailVal) { emailError.textContent = 'Email is required.'; valid = false; }
      else {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(emailVal)) { emailError.textContent = 'Invalid email address.'; valid = false; }
      }
      if (!addressInput.value.trim()) { addressError.textContent = 'Address is required.'; valid = false; }
      return valid;
    }

    payNowBtn.addEventListener('click', () => {
      paymentStatus.textContent = '';
      if (!validateForm()) {
        return;
      }
      const total = parseFloat(totalEl.textContent || '0');
      if (total <= 0) {
        paymentStatus.textContent = '';
        discountError.textContent = 'Cart is empty or total invalid.';
        return;
      }
      paymentStatus.textContent = 'Payment Successful!';
    });

    recalc();
  </script>
</body>
</html>